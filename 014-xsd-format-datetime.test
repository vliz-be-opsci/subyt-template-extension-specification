# j2-subyt-extension-tests
# type conversions -- to verify that input-output conversions work as expected 
#  -- testing the actual output of the filter `| xsd (value, type, quote)`
#  -- for various types 
# == xsd:datetime formatting  ================================================
# ----  from literal in template ---------------------------------------------

= reset assignments
?< 
  {{ "1970-05-06T16:25:50+02:00"  |xsd('datetime') }}
$>
  '1970-05-06T16:25:50+02:00'^^xsd:dateTime 
#

# verify double quote option
= reset assignments
?<
  {{ "2025-09-25T17:00:00" | xsd('xsd:datetime', '"') }}
?<
  {{ txt_Sep25_2025_5pm    | xsd('datetime', '"') }}
$>
  "2025-09-25T17:00:00"^^xsd:dateTime
#

# ---- from context variables  -----------------------------------------------
# ...... acceptable date value variants ......................................
= -- json does not allow to define typed dates, have to rely on BASE_CONTEXT
?<
  {{ dttm_Sep25_2025_5pm      | xsd('datetime') }}
$>
  '2025-09-25T17:00:00'^^xsd:dateTime
?<
  {{ txt_Sep25_2025_5pm_loc   | xsd('datetime') }}
?<
  {{ dttm_Sep25_2025_5pm_loc  | xsd('datetime') }}
$>
  '2025-09-25T17:00:00+02:00'^^xsd:dateTime
#


# ...... inacceptable date values .............................................
= add these to the BASE_CONTEXT:
  {
    "errmsg"    : "*** EXPECTED FAILURE MSG ***"
  }
?<
  {{ errmsg }}
?<
  {{ "anything"          | xsd('datetime', fb=errmsg) }}
?<
  {{ "3/14/15"           | xsd('datetime', fb=errmsg) }}
?<
  {{ dt_May6_1970        | xsd('datetime', fb=errmsg) }}
?<
  {{ none                | xsd('datetime', fb=errmsg) }}
?<
  {{ list_none           | xsd('datetime', fb=errmsg) }}
?<
  {{ dict_none           | xsd('datetime', fb=errmsg) }}
$>
  *** EXPECTED FAILURE MSG ***
#
